<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0">
<title>Dylan wordt 7! üéà</title>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
html, body {
  overflow: hidden; width: 100%; height: 100%;
  background: #1a1a2e;
  font-family: 'Segoe UI', Arial, sans-serif;
  touch-action: none; user-select: none;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
}
canvas#game { display: block; width: 100%; height: 100%; }

/* ---- START SCREEN ---- */
#startScreen, #inviteScreen {
  position: fixed; top: 0; left: 0; width: 100%; height: 100%;
  display: flex; flex-direction: column; align-items: center; justify-content: center;
  z-index: 10;
}
#startScreen {
  background: linear-gradient(135deg, #ff6b35, #ff3366, #7b2ff7);
  color: white; text-align: center; padding: 20px;
}
#startScreen h1 {
  font-size: clamp(2.5rem, 10vw, 4.5rem);
  text-shadow: 3px 3px 0 rgba(0,0,0,0.3);
  margin-bottom: 10px;
}
#startScreen p {
  font-size: clamp(1rem, 4vw, 1.5rem);
  margin-bottom: 10px; opacity: 0.9;
}
#startScreen .sub {
  font-size: clamp(0.85rem, 3vw, 1.1rem);
  margin-bottom: 30px; opacity: 0.75;
}
#startBtn {
  background: white; color: #ff3366; border: none;
  padding: 18px 60px; font-size: clamp(1.3rem, 5vw, 2rem);
  border-radius: 50px; cursor: pointer; font-weight: bold;
  box-shadow: 0 5px 20px rgba(0,0,0,0.3);
  transition: transform 0.2s; z-index: 2; position: relative;
}
#startBtn:active { transform: scale(0.95); }

/* ---- INVITE SCREEN ---- */
#inviteScreen {
  background: linear-gradient(135deg, #ff6b35, #ff3366, #7b2ff7);
  color: white; text-align: center;
  padding: 0; display: none;
  overflow-y: auto; -webkit-overflow-scrolling: touch;
  touch-action: pan-y;
}
#inviteInner {
  min-height: 100%; width: 100%;
  display: flex; flex-direction: column;
  align-items: center; justify-content: center;
  padding: 20px 15px;
}
#inviteCard {
  background: white; color: #333; border-radius: 20px;
  padding: 25px 20px; max-width: 400px; width: 100%;
  box-shadow: 0 10px 40px rgba(0,0,0,0.3);
}
#inviteCard h1 {
  color: #ff3366; font-size: clamp(1.2rem, 5vw, 2rem);
  margin-bottom: 5px;
}
#inviteCard h2 {
  color: #ff6b35; font-size: clamp(0.95rem, 3.5vw, 1.3rem);
  margin-bottom: 12px;
}
#dylanRow {
  display: flex; align-items: center; justify-content: center;
  gap: 10px; margin-bottom: 8px;
}
#dylanRow canvas {
  flex-shrink: 0;
}
.invite-detail {
  display: flex; align-items: center; gap: 8px;
  margin: 8px 0; font-size: clamp(0.8rem, 3vw, 1rem);
  text-align: left;
}
.invite-detail .icon { font-size: 1.2rem; min-width: 28px; text-align: center; }
.invite-footer {
  margin-top: 15px; padding-top: 10px; border-top: 2px dashed #ff3366;
  font-size: clamp(0.95rem, 3.5vw, 1.2rem); color: #ff3366; font-weight: bold;
}

/* ---- HUD ---- */
#hud {
  position: fixed; top: 8px; left: 8px; right: 8px;
  display: flex; justify-content: space-between; align-items: flex-start;
  z-index: 5; pointer-events: none;
}
#hud.hidden { display: none; }
.hud-left { display: flex; flex-direction: column; gap: 5px; }
.hud-item {
  background: rgba(0,0,0,0.7); color: white;
  padding: 5px 12px; border-radius: 20px;
  font-size: clamp(0.75rem, 2.8vw, 1rem); font-weight: bold;
}
.hud-item.lives { color: #ff6b6b; }
#caughtPanel {
  background: rgba(0,0,0,0.7); border-radius: 12px;
  padding: 6px; display: flex; flex-direction: column;
  align-items: center; gap: 3px; min-width: 44px;
}
#caughtPanel .label {
  color: white; font-size: clamp(0.55rem, 1.8vw, 0.7rem);
  font-weight: bold;
}
.caught-ball {
  width: clamp(16px, 4.5vw, 24px); height: clamp(16px, 4.5vw, 24px);
  border-radius: 50%; background: #e63946;
  box-shadow: inset -2px -2px 4px rgba(0,0,0,0.3), inset 3px 3px 4px rgba(255,255,255,0.3);
}

/* ---- GAME OVER ---- */
#gameOverOverlay {
  position: fixed; top: 0; left: 0; width: 100%; height: 100%;
  background: rgba(0,0,0,0.75); z-index: 8;
  display: none; flex-direction: column;
  align-items: center; justify-content: center;
  color: white; text-align: center; padding: 20px;
}
#gameOverOverlay h2 { font-size: clamp(1.5rem, 6vw, 2.5rem); margin-bottom: 15px; }
#gameOverOverlay p { font-size: clamp(1rem, 3.5vw, 1.3rem); margin-bottom: 25px; }
#retryBtn {
  background: #e63946; color: white; border: none;
  padding: 15px 50px; font-size: clamp(1.1rem, 4vw, 1.5rem);
  border-radius: 50px; cursor: pointer; font-weight: bold;
}
#retryBtn:active { transform: scale(0.95); }

/* ---- EFFECTS ---- */
.confetti-piece {
  position: fixed; width: 10px; height: 10px; z-index: 9;
  animation: confettiFall 3s ease-in forwards;
}
@keyframes confettiFall {
  0% { transform: translateY(-10px) rotate(0deg); opacity: 1; }
  100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
}
.float-ball {
  position: fixed; border-radius: 50%; z-index: 1;
  animation: floatUp linear infinite; opacity: 0.5;
}
@keyframes floatUp {
  0% { transform: translateY(100vh) rotate(0deg); opacity: 0.5; }
  100% { transform: translateY(-100px) rotate(360deg); opacity: 0; }
}
</style>
</head>
<body>

<!-- Start screen -->
<div id="startScreen">
  <h1>Dylan wordt 7!</h1>
  <p>Vang de RODE ballen!</p>
  <p class="sub">‚ö†Ô∏è Pas op voor de blauwe ballen!</p>
  <button id="startBtn">üéÆ SPELEN!</button>
</div>

<!-- Game canvas -->
<canvas id="game"></canvas>
<div id="hud" class="hidden">
  <div class="hud-left">
    <div class="hud-item">üî¥ <span id="score">0</span> / 20</div>
    <div class="hud-item lives" id="livesDisplay">‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</div>
  </div>
  <div id="caughtPanel">
    <div class="label">Gevangen</div>
  </div>
</div>

<!-- Game Over -->
<div id="gameOverOverlay">
  <h2>Oeps! üí•</h2>
  <p>Te veel blauwe ballen gevangen!<br>Probeer het nog een keer!</p>
  <button id="retryBtn">üîÑ OPNIEUW!</button>
</div>

<!-- Invite screen -->
<div id="inviteScreen">
  <div id="inviteInner">
    <div id="inviteCard">
      <div id="dylanRow">
        <canvas id="dylanInvite" width="70" height="100"></canvas>
        <div>
          <h1>üéâ Je bent uitgenodigd!</h1>
          <h2>Dylan wordt 7 jaar!</h2>
        </div>
      </div>
      <div class="invite-detail"><span class="icon">üìÖ</span><span>Woensdag 4 maart 2026</span></div>
      <div class="invite-detail"><span class="icon">üïê</span><span>We vertrekken om 14:00 uur</span></div>
      <div class="invite-detail"><span class="icon">üìç</span><span>Kampenhout 17</span></div>
      <div class="invite-detail"><span class="icon">üéÇ</span><span>Taart, spelen & een leuke verrassing!</span></div>
      <div class="invite-detail"><span class="icon">üöó</span><span>Je wordt met een volle buik thuisgebracht!</span></div>
      <div class="invite-footer">
        Kom je ook? üéà<br>
        Groetjes, Dylan!
      </div>
    </div>
  </div>
</div>

<script>
// ============ DRAW DYLAN CHARACTER (reusable) ============
function drawDylan(c, px, py, scale) {
  const s = scale || 1;
  c.save();
  c.translate(px, py);
  c.scale(s, s);

  // Legs (jeans)
  c.fillStyle = '#4a6fa5';
  c.fillRect(-12, 50, 10, 25);
  c.fillRect(2, 50, 10, 25);

  // Shoes
  c.fillStyle = '#8B7355';
  c.fillRect(-14, 73, 14, 7);
  c.fillRect(1, 73, 14, 7);

  // Torso - orange top
  c.fillStyle = '#ff6b35';
  c.fillRect(-15, 25, 30, 18);
  // White band
  c.fillStyle = '#ffffff';
  c.fillRect(-15, 43, 30, 8);
  // Navy bottom
  c.fillStyle = '#1a1a4e';
  c.fillRect(-15, 51, 30, 10);

  // Arms
  c.fillStyle = '#1a1a4e';
  c.fillRect(-22, 28, 8, 25);
  c.fillRect(14, 28, 8, 25);

  // Head
  c.fillStyle = '#fdbf9c';
  c.beginPath();
  c.arc(0, 18, 14, 0, Math.PI * 2);
  c.fill();

  // Hair (brown)
  c.fillStyle = '#8B6914';
  c.beginPath();
  c.ellipse(0, 10, 16, 10, 0, Math.PI, 0);
  c.fill();
  c.fillRect(-14, 8, 6, 12);
  c.fillRect(8, 8, 6, 12);
  c.fillRect(-10, 5, 20, 6);

  // Eyes
  c.fillStyle = '#333';
  c.beginPath();
  c.arc(-5, 18, 2, 0, Math.PI * 2);
  c.arc(5, 18, 2, 0, Math.PI * 2);
  c.fill();

  // Smile
  c.strokeStyle = '#333';
  c.lineWidth = 1.5;
  c.beginPath();
  c.arc(0, 22, 5, 0.1, Math.PI - 0.1);
  c.stroke();

  c.restore();
}

function drawDylanOnInvite() {
  const cv = document.getElementById('dylanInvite');
  const cx = cv.getContext('2d');
  cx.clearRect(0, 0, cv.width, cv.height);
  drawDylan(cx, 35, 10, 1.1);
}

// ============ FLOATING BALLS START SCREEN ============
const startBallColors = ['#e63946','#457b9d','#e63946','#457b9d','#ff6b6b','#5fa8d3'];
function addFloatingBalls() {
  for (let i = 0; i < 20; i++) {
    const b = document.createElement('div');
    b.className = 'float-ball';
    const size = 15 + Math.random() * 30;
    b.style.width = size + 'px'; b.style.height = size + 'px';
    b.style.left = Math.random() * 100 + '%';
    b.style.background = startBallColors[Math.floor(Math.random() * startBallColors.length)];
    b.style.animationDuration = (3 + Math.random() * 5) + 's';
    b.style.animationDelay = Math.random() * 5 + 's';
    document.getElementById('startScreen').appendChild(b);
  }
}
addFloatingBalls();

// ============ GAME ENGINE ============
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');
let W, H;

function resize() {
  W = canvas.width = window.innerWidth;
  H = canvas.height = window.innerHeight;
}
resize();
window.addEventListener('resize', resize);

let gameRunning = false;
let score = 0;
let lives = 3;
let balls = [];
let particles = [];
let spawnTimer = 0;
let playerX = 0;
let targetX = 0;
let shakeTimer = 0;
const CATCH_TARGET = 20;

const player = {
  w: 60, h: 80,
  get y() { return H - this.h - 15; },
  bucketW: 75
};

function spawnBall() {
  const r = 14 + Math.random() * 8;
  const isRed = Math.random() < 0.6;
  balls.push({
    x: Math.random() * (W - 60) + 30,
    y: -r - Math.random() * 40,
    r, isRed,
    vy: 2 + Math.random() * 2 + score * 0.1,
    vx: (Math.random() - 0.5) * 2,
    color: isRed ? '#e63946' : '#457b9d'
  });
}

function spawnParticles(x, y, color) {
  for (let i = 0; i < 10; i++) {
    particles.push({
      x, y, r: 2 + Math.random() * 4,
      vx: (Math.random() - 0.5) * 8,
      vy: -Math.random() * 6 - 2,
      color, life: 1
    });
  }
}

function spawnConfetti() {
  const colors = ['#e63946','#ff6b35','#f4a261','#2a9d8f','#457b9d','#e9c46a','#a855f7'];
  for (let i = 0; i < 80; i++) {
    const c = document.createElement('div');
    c.className = 'confetti-piece';
    c.style.left = Math.random() * 100 + '%'; c.style.top = '-10px';
    c.style.background = colors[Math.floor(Math.random() * colors.length)];
    c.style.borderRadius = Math.random() > 0.5 ? '50%' : '2px';
    c.style.width = (5 + Math.random() * 10) + 'px';
    c.style.height = (5 + Math.random() * 10) + 'px';
    c.style.animationDelay = Math.random() * 1 + 's';
    document.body.appendChild(c);
    setTimeout(() => c.remove(), 4000);
  }
}

function addCaughtBallUI() {
  const panel = document.getElementById('caughtPanel');
  const b = document.createElement('div');
  b.className = 'caught-ball';
  panel.appendChild(b);
}

function updateLivesDisplay() {
  document.getElementById('livesDisplay').textContent = '‚ù§Ô∏è'.repeat(Math.max(0, lives));
}

// ============ DRAWING ============
function drawBackground() {
  const grd = ctx.createLinearGradient(0, 0, 0, H);
  grd.addColorStop(0, '#2d1b3d');
  grd.addColorStop(0.5, '#1a1a2e');
  grd.addColorStop(1, '#16213e');
  ctx.fillStyle = grd;
  ctx.fillRect(0, 0, W, H);

  ctx.save();
  ctx.globalAlpha = 0.1;
  drawGear(W * 0.12, H * 0.2, 40, Date.now() * 0.001);
  drawGear(W * 0.88, H * 0.15, 30, -Date.now() * 0.0015);
  drawGear(W * 0.5, H * 0.08, 22, Date.now() * 0.002);
  ctx.restore();

  ctx.strokeStyle = '#4a4a6a';
  ctx.lineWidth = 6;
  ctx.beginPath();
  ctx.moveTo(0, H * 0.3); ctx.lineTo(W * 0.25, H * 0.3);
  ctx.moveTo(W * 0.75, H * 0.25); ctx.lineTo(W, H * 0.25);
  ctx.stroke();

  // Conveyor belt
  ctx.fillStyle = '#2a2a4a';
  ctx.fillRect(0, H - 8, W, 8);
  ctx.strokeStyle = '#3a3a5a'; ctx.lineWidth = 1;
  for (let x = (Date.now() * 0.05) % 30; x < W; x += 30) {
    ctx.beginPath(); ctx.moveTo(x, H - 8); ctx.lineTo(x, H); ctx.stroke();
  }

  ctx.fillStyle = 'rgba(255,255,255,0.05)';
  ctx.font = `bold ${Math.min(W * 0.07, 45)}px Arial`;
  ctx.textAlign = 'center';
  ctx.fillText('BALLENFABRIEK', W / 2, H * 0.45);
}

function drawGear(x, y, r, angle) {
  ctx.save();
  ctx.translate(x, y); ctx.rotate(angle);
  ctx.fillStyle = '#c9a84c';
  ctx.beginPath();
  for (let i = 0; i < 8; i++) {
    const a = (i / 8) * Math.PI * 2;
    const a2 = ((i + 0.3) / 8) * Math.PI * 2;
    const a3 = ((i + 0.5) / 8) * Math.PI * 2;
    const a4 = ((i + 0.8) / 8) * Math.PI * 2;
    if (i === 0) ctx.moveTo(Math.cos(a) * r, Math.sin(a) * r);
    ctx.lineTo(Math.cos(a2) * (r + 8), Math.sin(a2) * (r + 8));
    ctx.lineTo(Math.cos(a3) * (r + 8), Math.sin(a3) * (r + 8));
    ctx.lineTo(Math.cos(a4) * r, Math.sin(a4) * r);
  }
  ctx.closePath(); ctx.fill();
  ctx.beginPath(); ctx.arc(0, 0, r * 0.35, 0, Math.PI * 2);
  ctx.fillStyle = '#2d1b3d'; ctx.fill();
  ctx.restore();
}

function drawPlayerGame() {
  const px = playerX;
  const py = player.y;

  // Bucket
  ctx.save();
  ctx.strokeStyle = '#ff6b35'; ctx.lineWidth = 3;
  ctx.beginPath();
  const bw = player.bucketW;
  ctx.moveTo(px - bw/2, py);
  ctx.lineTo(px - bw/2 + 10, py + 28);
  ctx.lineTo(px + bw/2 - 10, py + 28);
  ctx.lineTo(px + bw/2, py);
  ctx.closePath();
  ctx.fillStyle = 'rgba(255,107,53,0.25)';
  ctx.fill(); ctx.stroke();
  ctx.restore();

  drawDylan(ctx, px, py + 5, 1);
}

function drawBall(b) {
  ctx.beginPath();
  ctx.arc(b.x + 2, b.y + 2, b.r, 0, Math.PI * 2);
  ctx.fillStyle = 'rgba(0,0,0,0.2)'; ctx.fill();

  ctx.beginPath();
  ctx.arc(b.x, b.y, b.r, 0, Math.PI * 2);
  const grad = ctx.createRadialGradient(b.x - b.r*0.3, b.y - b.r*0.3, b.r*0.1, b.x, b.y, b.r);
  if (b.isRed) { grad.addColorStop(0,'#ff8a8a'); grad.addColorStop(1,'#c1121f'); }
  else { grad.addColorStop(0,'#8ac4e6'); grad.addColorStop(1,'#1d3557'); }
  ctx.fillStyle = grad; ctx.fill();

  ctx.beginPath();
  ctx.arc(b.x - b.r*0.3, b.y - b.r*0.3, b.r*0.2, 0, Math.PI * 2);
  ctx.fillStyle = 'rgba(255,255,255,0.5)'; ctx.fill();
}

function drawParticles() {
  particles.forEach(p => {
    ctx.globalAlpha = p.life;
    ctx.beginPath(); ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2);
    ctx.fillStyle = p.color; ctx.fill();
  });
  ctx.globalAlpha = 1;
}

// ============ UPDATE ============
function update() {
  playerX += (targetX - playerX) * 0.18;
  playerX = Math.max(player.bucketW/2 + 5, Math.min(W - player.bucketW/2 - 5, playerX));

  spawnTimer++;
  const spawnRate = Math.max(8, 20 - score * 0.5);
  if (spawnTimer >= spawnRate) {
    spawnTimer = 0;
    const count = Math.min(1 + Math.floor(score / 4), 4);
    for (let i = 0; i < count; i++) spawnBall();
  }

  for (let i = balls.length - 1; i >= 0; i--) {
    const b = balls[i];
    b.x += b.vx; b.y += b.vy; b.vy += 0.06;
    if (b.x < b.r) { b.x = b.r; b.vx *= -1; }
    if (b.x > W - b.r) { b.x = W - b.r; b.vx *= -1; }

    const bucketTop = player.y;
    const bucketBottom = player.y + 28;
    if (b.y + b.r > bucketTop && b.y - b.r < bucketBottom &&
        b.x > playerX - player.bucketW/2 && b.x < playerX + player.bucketW/2) {
      if (b.isRed) {
        score++;
        document.getElementById('score').textContent = score;
        spawnParticles(b.x, b.y, '#ff6b6b');
        addCaughtBallUI();
        balls.splice(i, 1);
        if (score >= CATCH_TARGET) {
          gameRunning = false;
          setTimeout(showInvite, 600);
          return;
        }
      } else {
        lives--;
        updateLivesDisplay();
        spawnParticles(b.x, b.y, '#457b9d');
        shakeTimer = 10;
        balls.splice(i, 1);
        if (lives <= 0) {
          gameRunning = false;
          setTimeout(showGameOver, 400);
          return;
        }
      }
      continue;
    }
    if (b.y > H + 50) balls.splice(i, 1);
  }

  for (let i = particles.length - 1; i >= 0; i--) {
    const p = particles[i];
    p.x += p.vx; p.y += p.vy; p.vy += 0.15; p.life -= 0.03;
    if (p.life <= 0) particles.splice(i, 1);
  }
}

function getShakeOffset() {
  if (shakeTimer > 0) {
    shakeTimer--;
    return { x: (Math.random()-0.5)*8, y: (Math.random()-0.5)*8 };
  }
  return { x: 0, y: 0 };
}

function gameLoop() {
  if (!gameRunning) return;
  const shake = getShakeOffset();
  ctx.save(); ctx.translate(shake.x, shake.y);
  drawBackground();
  balls.forEach(drawBall);
  drawParticles();
  drawPlayerGame();
  ctx.restore();
  update();
  requestAnimationFrame(gameLoop);
}

// ============ INPUT (mobile optimized) ============
function handleMove(x) { if (gameRunning) targetX = x; }
canvas.addEventListener('mousemove', e => handleMove(e.clientX));
canvas.addEventListener('touchmove', e => { e.preventDefault(); handleMove(e.touches[0].clientX); }, { passive: false });
canvas.addEventListener('touchstart', e => { e.preventDefault(); handleMove(e.touches[0].clientX); }, { passive: false });
document.addEventListener('gesturestart', e => e.preventDefault());
document.addEventListener('gesturechange', e => e.preventDefault());

// ============ GAME FLOW ============
function startGame() {
  document.getElementById('startScreen').style.display = 'none';
  document.getElementById('gameOverOverlay').style.display = 'none';
  document.getElementById('inviteScreen').style.display = 'none';
  document.getElementById('hud').classList.remove('hidden');
  const panel = document.getElementById('caughtPanel');
  panel.querySelectorAll('.caught-ball').forEach(b => b.remove());

  gameRunning = true;
  score = 0; lives = 5;
  balls = []; particles = [];
  spawnTimer = 0;
  document.getElementById('score').textContent = '0';
  updateLivesDisplay();
  resize();
  playerX = W / 2; targetX = W / 2;
  gameLoop();
}

document.getElementById('startBtn').addEventListener('click', startGame);
document.getElementById('retryBtn').addEventListener('click', startGame);

function showGameOver() {
  document.getElementById('hud').classList.add('hidden');
  document.getElementById('gameOverOverlay').style.display = 'flex';
}

function showInvite() {
  document.getElementById('hud').classList.add('hidden');
  document.getElementById('inviteScreen').style.display = 'flex';
  drawDylanOnInvite();
  spawnConfetti();
  setTimeout(spawnConfetti, 1000);
  setTimeout(spawnConfetti, 2000);
}
</script>
</body>
</html>
